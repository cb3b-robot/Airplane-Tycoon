<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Airplane Tycoon Ultimate</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
html, body { height:100%; margin:0; font-family:Arial,sans-serif; }
#map { height:50%; }
#ui { padding:10px; }
button { margin:2px; }
#notifications { position: fixed; bottom:10px; right:10px; width:300px; }
.notification { background:#333; color:#fff; padding:5px 10px; margin-top:5px; border-radius:5px; opacity:0.9; }
#missionList, #achievementList { margin-top:5px; }
</style>
</head>
<body>
<div id="map"></div>
<div id="ui">
  <h2 id="companyNameDisplay">Airplane Tycoon</h2>
  <div id="timeDisplay"></div>
  <div>Money: $<span id="money">0</span></div>
  <button onclick="buyPlane()">Buy Plane ($50,000)</button>
  <button onclick="restartGame()">Restart Game</button>
  <label><input type="checkbox" id="autoFlyToggle" onchange="toggleAutoFly()"> Auto-Fly</label>
  <label><input type="checkbox" id="autoMaintainToggle" onchange="toggleAutoMaintain()"> Auto-Maintain</label>

  <h3>Airports</h3>
  <div id="airportList"></div>
  
  <h3>Planes</h3>
  <div id="planeList"></div>

  <h3>Missions</h3>
  <div id="missionList"></div>

  <h3>Achievements</h3>
  <div id="achievementList"></div>
</div>
<div id="notifications"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
// --- GAME STATE ---
let gameState = {
    companyName:"",
    money:150000,
    airports:[],
    planes:[],
    time:{day:1,hour:6,minute:0},
    moneyMultiplier:1,
    missions:[],
    achievements:[]
};
let autoFly=false;
let autoMaintain=false;

// --- AIRPORT DATA (50+) ---
const airportData=[
    {name:"JFK",lat:40.6413,lon:-73.7781},{name:"LAX",lat:33.9416,lon:-118.4085},
    {name:"ORD",lat:41.9742,lon:-87.9073},{name:"ATL",lat:33.6407,lon:-84.4277},
    {name:"DFW",lat:32.8998,lon:-97.0403},{name:"DEN",lat:39.8561,lon:-104.6737},
    {name:"SFO",lat:37.6213,lon:-122.379},{name:"SEA",lat:47.4502,lon:-122.3088},
    {name:"MIA",lat:25.7959,lon:-80.287},{name:"PHX",lat:33.4342,lon:-112.0116},
    {name:"IAH",lat:29.9902,lon:-95.3368},{name:"LAS",lat:36.084,lon:-115.1537},
    {name:"MCO",lat:28.4312,lon:-81.3081},{name:"EWR",lat:40.6895,lon:-74.1745},
    {name:"MSP",lat:44.8848,lon:-93.2223},{name:"BOS",lat:42.3656,lon:-71.0096},
    {name:"CLT",lat:35.214,lon:-80.9431},{name:"PHL",lat:39.8719,lon:-75.2411},
    {name:"LGA",lat:40.7769,lon:-73.874},{name:"FLL",lat:26.0726,lon:-80.1528},
    {name:"DTW",lat:42.2162,lon:-83.3554},{name:"SLC",lat:40.7899,lon:-111.9791},
    {name:"SAN",lat:32.7338,lon:-117.1933},{name:"PDX",lat:45.5898,lon:-122.5951},
    {name:"HNL",lat:21.3187,lon:-157.9225},{name:"BWI",lat:39.1794,lon:-76.6683},
    {name:"DCA",lat:38.8512,lon:-77.0402},{name:"OAK",lat:37.7126,lon:-122.221},
    {name:"STL",lat:38.7478,lon:-90.3597},{name:"TPA",lat:27.9755,lon:-82.5332},
    {name:"PDL",lat:28.5932,lon:-81.3056},{name:"MCI",lat:39.2976,lon:-94.7139},
    {name:"HOU",lat:29.6454,lon:-95.2789},{name:"SJC",lat:37.3639,lon:-121.9289},
    {name:"SMF",lat:38.6951,lon:-121.591},{name:"MKE",lat:42.9472,lon:-87.8966},
    {name:"CLE",lat:41.4117,lon:-81.8498},{name:"BUF",lat:42.9405,lon:-78.7322},
    {name:"RDU",lat:35.8776,lon:-78.7875},{name:"PIT",lat:40.4956,lon:-80.2329},
    {name:"SNA",lat:33.6757,lon:-117.8682},{name:"ONT",lat:34.056,lon:-117.601},
    {name:"DAL",lat:32.8471,lon:-96.8517},{name:"RSW",lat:26.5362,lon:-81.7552},
    {name:"AUS",lat:30.1945,lon:-97.6699},{name:"IND",lat:39.7173,lon:-86.2943},
    {name:"CMH",lat:39.9981,lon:-82.8911},{name:"SDF",lat:38.1744,lon:-85.7369},
    {name:"BNA",lat:36.1245,lon:-86.6782},{name:"RIC",lat:37.5052,lon:-77.3196},
    {name:"PBI",lat:26.6832,lon:-80.0956}
];

// --- INITIALIZE AIRPORTS ---
airportData.forEach((a,i)=>{
    gameState.airports.push({
        name: a.name,
        lat: a.lat,
        lon: a.lon,
        level:1,
        unlocked: i<3,
        baseCost: 50000 + i*15000,
        revenueMultiplier:1
    });
});

// --- MAP ---
const map = L.map('map').setView([39.5,-98.35],4);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OpenStreetMap contributors'}).addTo(map);
let planeMarkers={};

// --- PLANE TYPES ---
const planeTypes=[
    {name:"Tiny Plane", speed:500, cost:50000, profitMultiplier:1, fuel:100},
    {name:"Regional Jet", speed:700, cost:150000, profitMultiplier:2, fuel:150},
    {name:"Boeing 737", speed:850, cost:500000, profitMultiplier:3, fuel:300},
    {name:"Boeing 747", speed:900, cost:1000000, profitMultiplier:5, fuel:500}
];

// --- NOTIFICATIONS ---
function notify(msg){const n=document.createElement('div');n.className="notification";n.innerText=msg;document.getElementById("notifications").appendChild(n);setTimeout(()=>n.remove(),4000);}

// --- COMPANY NAME ---
function askCompanyName(){const name=prompt("Enter your airline company name:");gameState.companyName=name||"Airplane Tycoon";document.getElementById('companyNameDisplay').innerText=gameState.companyName;}
askCompanyName();

// --- SAVE/LOAD ---
function saveGame(){localStorage.setItem("airplaneTycoonUltimate",JSON.stringify(gameState));}
function loadGame(){const saved=localStorage.getItem("airplaneTycoonUltimate");if(saved)gameState=JSON.parse(saved);}
loadGame();

// --- UI UPDATE ---
function updateUI(){
    document.getElementById('money').innerText=Math.round(gameState.money);
    const airportDiv=document.getElementById('airportList'); airportDiv.innerHTML='';
    gameState.airports.forEach(a=>{
        const btn=document.createElement('button');
        if(a.unlocked){
            btn.innerText=`${a.name} (Lvl ${a.level}) Upgrade $${Math.round(a.baseCost*1.5**(a.level-1))}`;
            btn.disabled=gameState.money<a.baseCost*1.5**(a.level-1);
            btn.onclick=()=>upgradeAirport(a);
        } else{
            btn.innerText=`Unlock ${a.name} $${a.baseCost}`; btn.disabled=gameState.money<a.baseCost; btn.onclick=()=>unlockAirport(a);
        }
        airportDiv.appendChild(btn);
    });
    const planeDiv=document.getElementById('planeList'); planeDiv.innerHTML='';
    gameState.planes.forEach((p,i)=>{
        const div=document.createElement('div');
        div.innerHTML=`✈️ ${p.name} (${planeTypes[p.type].name}) - ${p.status} 
        <button onclick="autoFlyPlane(${i})">Auto-Fly</button>
        <button onclick="upgradePlane(${i})">Upgrade</button>
        <button onclick="renamePlane(${i})">Rename</button>`;
        planeDiv.appendChild(div);
    });
}
updateUI();

// --- AIRPORT FUNCTIONS ---
function unlockAirport(a){if(gameState.money>=a.baseCost){gameState.money-=a.baseCost;a.unlocked=true;notify(`${a.name} unlocked!`);updateUI();saveGame();}}
function upgradeAirport(a){const cost=Math.round(a.baseCost*1.5**(a.level-1));if(gameState.money>=cost){gameState.money-=cost;a.level++;notify(`${a.name} upgraded!`);updateUI();saveGame();}}

// --- PLANE FUNCTIONS ---
function buyPlane(){const type=0; const cost=planeTypes[type].cost;if(gameState.money>=cost){gameState.money-=cost; const p={name:`Plane ${gameState.planes.length+1}`,type:type,status:"idle",lat:gameState.airports[0].lat,lon:gameState.airports[0].lon,queue:[]};gameState.planes.push(p);notify(`${p.name} purchased!`);updateUI();saveGame();addPlaneMarker(p);} else notify("Not enough money!");}
function upgradePlane(i){const p=gameState.planes[i]; if(p.type<planeTypes.length-1){const next=p.type+1; const cost=planeTypes[next].cost; if(gameState.money>=cost){gameState.money-=cost;p.type=next;notify(`${p.name} upgraded!`);updateUI();saveGame();} else notify("Not enough money!");} else notify("Max plane!");}
function renamePlane(i){const p=gameState.planes[i]; const name=prompt("New name:",p.name); if(name)p.name=name;notify(`${p.name} renamed!`);updateUI();saveGame();}

// --- AUTO FLY ---
function autoFlyPlane(i){const p=gameState.planes[i]; const unlocked=gameState.airports.filter(a=>a.unlocked&&(a.lat!==p.lat||a.lon!==p.lon)); if(unlocked.length===0){notify("No unlocked airports!");return;}const dest=unlocked[Math.floor(Math.random()*unlocked.length)];p.queue=[dest.name];p.status="flying";notify(`${p.name} flying to ${dest.name}`);updateUI();saveGame();}

// --- TOGGLES ---
function toggleAutoFly(){autoFly=document.getElementById("autoFlyToggle").checked;}
function toggleAutoMaintain(){autoMaintain=document.getElementById("autoMaintainToggle").checked;}

// --- RESTART ---
function restartGame(){if(confirm("Restart game?")){localStorage.clear();location.reload();}}

// --- PLANE MARKERS & MOVEMENT ---
function addPlaneMarker(p){planeMarkers[p.name]=L.marker([p.lat,p.lon],{icon:L.divIcon({className:'plane-marker',html:'✈️'})}).addTo(map);}
function movePlanes(){gameState.planes.forEach(p=>{if(p.status==="flying"&&p.queue.length>0){const dest=gameState.airports.find(a=>a.name===p.queue[0]);if(!dest)return;const dx=dest.lat-p.lat;const dy=dest.lon-p.lon;const dist=Math.sqrt(dx*dx+dy*dy);const speed=planeTypes[p.type].speed/1000;if(dist<0.01){p.lat=dest.lat;p.lon=dest.lon;p.status="idle";p.queue.shift();const profit=1000*planeTypes[p.type].profitMultiplier*dest.level*gameState.moneyMultiplier;gameState.money+=profit;notify(`${p.name} arrived at ${dest.name}! Earned $${Math.round(profit)}`);} else {p.lat+=dx*speed;p.lon+=dy*speed;}planeMarkers[p.name].setLatLng([p.lat,p.lon]);}});}
setInterval(movePlanes,1000);

// --- GAME TIME ---
function advanceTime(){gameState.time.minute+=10;if(gameState.time.minute>=60){gameState.time.minute=0; gameState.time.hour++;}if(gameState.time.hour>=24){gameState.time.hour=0;gameState.time.day++;}document.getElementById('timeDisplay').innerText=`Day ${gameState.time.day}, ${gameState.time.hour.toString().padStart(2,'0')}:${gameState.time.minute.toString().padStart(2,'0')}`;}
setInterval(()=>{advanceTime();saveGame();},1000);

// --- INITIAL MARKERS ---
gameState.planes.forEach(addPlaneMarker);
</script>
</body>
</html>
